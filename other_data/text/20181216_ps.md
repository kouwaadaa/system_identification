# 進捗報告
## 0. 目次
 1. 前回までの内容
 2. やったこと その壱
 3. やったこと その弐
 4. まとめと今後の課題

## 1. 前回までの内容
- ローパスフィルタにより，実験データのノイズを取り除く．

- フィルタでカットする基準について検討する．
  - 時間領域 → 周波数領域

## 2. やったこと その壱
### 2.1 フーリエ変換の利用
- Fig. 2.1は，$y$軸まわりの角振動数を例に，時系列データと，周波数データを表示している．
![d_theta](../image/d_theta_freq.png)
<div style="text-align: center; font-style:oblique;">
  <b>Fig. 2.1</b>: Y-axis angular velocity (d_theta) in time and frequency domain
</div>

- 離散データの性質上，1周期の半分しか見ることができない
（そのため，25Hzを境に左右対称なグラフになっている）

- Pixhawkではこれ以上細かくデータを取ることができない（？）

### 2.2 機体のダイナミクスから検討する必要性
- カットする周波数帯を決めるために，機体の固有振動数を見る．
  - そのために機体の運動方程式を線形化したい．
  - 目標として，運動方程式をベクトル形で表したとき，

    $\bf{\dot x}=Ax + Bu$

    のような型にしたい．

## 3. やったこと その弐
### 3.1 運動方程式の整理
- 線形化のために，これまでに定式化されたモデルを見直す．
  - 記号や仮定など，統一されるべき点を丁寧に

- 原点のとり方を変更した．
  - 重心を原点としていたのを，重心より42mm後方かつ33mm上方の点を原点にした．（2/3スケールで）
  - ペイロードに荷物を乗せるなど，重心の位置が変わっても，モデル式自体を変更する必要がないため

### 3.2 各式のまとめ
- 空気力

  - 揚力と抗力はそれぞれ以下のように表される．
  $$\begin{align}
    L &= \bar{q}SC_L + k_LV \tag{3.2-1} \\
    D &= \bar{q}SC_D + k_DV \tag{3.2-2} \\
  \end{align}$$

- 並進の運動方程式

  - 機体座標系での並進の運動方程式は以下のように表される．
  $$\begin{align}
    m\left[
    \begin{array}{c}
    \dot{u} + qw - rv \\
    \dot{v} + ru - pw \\
    \dot{w} + pv - qu \\
    \end{array}
    \right] = mg
    \left[
    \begin{array}{c}
    -\sin\Theta \\
    \cos\Theta \sin\Phi \\
    \cos\Theta \cos\Phi \\
    \end{array}
  \right] + \left[
    \begin{array}{c}
    X\\Y\\Z\\
    \end{array}
    \right] \tag{3.2-3}
  \end{align}$$

  - 機体に働く並進力
  $$\begin{align}
      X &= X_t + X_a \tag{3.2-4} \\
      Y &= Y_t + Y_a \tag{3.2-5} \\
      Z &= Z_t + Z_a \tag{3.2-6}
    \end{align}$$

  - ロータによる推進力（$\gamma$ : メインロータのティルト角）
  $$\begin{align}
    X_t &= T_m \sin\gamma \tag{3.2-7} \\
    Y_t &= 0 \tag{3.2-8} \\
    Z_t &= -Tm\cos\gamma - (T_r + T_f) \tag{3.2-9} \\
    \end{align}$$

  - 空気力による並進力
  $$\begin{align}
    X_a &= L\sin\alpha - D\cos\alpha \tag{3.2-10} \\
    Y_a &= \bar{q}SC_y + k_yv \tag{3.2-11} \\
    Z_a &= -L\cos\alpha - \sin\alpha \tag{3.2-12} \\
  \end{align}$$

- 回転の運動方程式
  - 機体座標系での回転の運動方程式は，慣性乗積 $I_{xy}=I_{yz}=0$ とみなすと，以下のように表される．
  $$\begin{align}
    I_{xx}\dot{p} - I_{xz}\dot{r} + (I_{zz}-I_{yy})qr - I_{xz}pq &= L \tag{3.2-13}\\
    I_{yy}\dot{q} + (I_{xx} - I_{zz})rp + I_{xz}(p^2 - r^2) &= M \tag{3.2-14}\\
    I_{zz}\dot{r} - I_{xz}\dot{p} + (I_{yy} -I_{xx})pq + I_{xz}qr &= N \tag{3.2-15}
  \end{align}$$

  - 機体に作用するモーメント（重力によるモーメント項を追加）
  $$\begin{align}
      L &= L_t + L_a + L_g \tag{3.2-16} \\
      M &= M_t + M_a + M_g \tag{3.2-17} \\
      N &= N_t + N_a + N_g \tag{3.2-18}
    \end{align}$$

  - ロータによるモーメント
  $$\begin{align}
    L_t &= -(k_{T_1}T_1-k_{T_2}T_2)\sin\gamma + l_{r_y}(T_4 - T_3) \tag{3.2-19} \\
    M_t &= l_f - l_mT_m\cos\gamma + R_{G_z}T_m\sin\gamma - l_{r_x}T_r  \tag{3.2-20} \\
    N_t &= (k_{T_1}T_1-k_{T_2}T_2)\cos\gamma \tag{3.2-21} \\
    \end{align}$$

  - 空気力によるモーメント
  $$\begin{align}
    L_a &= \bar{q}SbC_l + k_lV \tag{3.2-22} \\
    M_a &= \bar{q}S\bar{c}C_m + k_mV \tag{3.2-23} \\
    N_a &= \bar{q}S\bar{c}C_n + k_nV \tag{3.2-24}
  \end{align}$$

  - 重力によるモーメント
  $$\begin{align}
    L_g &= R_{G_z}mg\cos\Theta\sin\Phi \tag{3.2-25} \\
    M_g &= -R_{G_z}mg\sin\Theta - R_{G_x}mg\cos\Theta\cos\Phi \tag{3.2-26} \\
    N_g &= R_{G_x}mg\cos\Theta\sin\Phi \tag{3.2-27}
  \end{align}$$

- 空力係数
$$\begin{align}
  C_y &= C_{y_0} + C_{y_\beta}\beta + C_{y_p}\dfrac{b}{2V}p + C_{y_r}\dfrac{b}{2V}r + C_{y_{\delta_a}}\delta_a \tag{3.2-28} \\
  C_l &= C_{l_0} + C_{l_\beta}\beta + C_{l_p}\dfrac{b}{2V}p + C_{l_r}\dfrac{b}{2V}r + C_{l_{\delta_a}}\delta_a \tag{3.2-29} \\
  C_m &= C_{m_0} + C_{m_\alpha}\alpha + C_{m_q}\dfrac{\bar{c}}{2V}q + C_{m_{\delta_e}}\delta_e \tag{3.2-30} \\
  C_n &= C_{n_0} + C_{n_\beta}\beta + C_{n_p}\dfrac{b}{2V}p + C_{n_r}\dfrac{b}{2V}r + C_{n_{\delta_a}}\delta_a \tag{3.2-31} \\
  C_L &= C_{L_0} + C_{L_\alpha}\alpha + C_{L_q}\dfrac{\bar{c}}{2V}q + C_{L_{\delta_e}}\delta_e \tag{3.2-32} \\
  C_D &= C_{D_0} + \kappa C_L^2 \tag{3.2-33}
\end{align}$$

### 3.3 縦系の運動の基礎式
(3.2-3)式において，横・方向系の運動状態変数を $v=p=r=\psi=0$ とおけば，

$$\begin{align}
  \dot{u} &= -qw - g\sin\Theta + \dfrac{T_m}{m}\sin\gamma + \dfrac{X}{m} \tag{3.3-1} \\
  \dot{w} &= -qu + g\cos\Theta - \dfrac{T_m\cos\gamma - (T_r+T_f)}{m} - \dfrac{Z}{m} \tag{3.3-2}
\end{align}$$

  となる．また，$y$軸まわりの運動方程式は，(3.2-14)式から次式で与えられる．

$$I_{yy}\dot{q} = M \tag{3.3-3}$$

### 3.4 縦系の運動方程式の線形化
- 定常飛行状態から運動が変化した場合の微小擾乱を仮定して，近似を行なう．

## 4. まとめと今後の課題
- 本研究における，フーリエ変換による実験データのフィルタリングは，適していない．
- 空気力による並進力やモーメントの式の仮定をさらに検討する必要がある．
- 縦系の運動方程式の線形化の準備を整えた．
  - 妥当な近似をよく検討し，線形化をしていきたい．

- できるだけ式をベクトルや行列表記にまとめ，ミスがないようにしたい．
